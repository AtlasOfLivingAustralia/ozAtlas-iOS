

<!DOCTYPE html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <script src="static/t5OGphSUjwdNOoxNKgdRTTh1RBtmzhMXxHDYYeR4lYj.js" type="text/javascript" ></script>
<link href="static/090onaZX1M508oSWqGmMeETZ9NkUA9p4CCTW3MUpRPc.css" type="text/css" rel="stylesheet" media="screen, projection" />

<link href="static/VySgOjkVOsD8Jt8ujXROVRjZeDLAAwVhMF5WqPZ8Ajf.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="http://www.ala.org.au/wp-content/themes/ala2011/images/favicon.ico" rel="shortcut icon" />
<!--[if lt IE 9]><script src="static/Yh1Txee3hFzExJ4P1str7tGV24zQMEYtxqtlYJ5ukR0.js" type="text/javascript" ></script><![endif]-->
<link href="static/Qwaw257M4sHcJuspEDRbeQoTceByqRmOCHNaZWpOxuc.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/AcXIjLTuc87n8sfxBjJRQSoBIUwP9RnCyK8Sv82i7eV.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/doSKUivnfI9gXmPKZ2XG4W5xIABYgKaf5Dwf3LtjNVr.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/fx5pGfEFSRJi6nyez3s8fUsjDL8WJ0IB04Njm7T2VAJ.css" type="text/css" rel="stylesheet" media="all" />
<link href="static/iHX8x0PqEmsjgyBEeq6NRvjAytsYzmt25tsjtHoHXDq.css" type="text/css" rel="stylesheet" media="screen,print" />




<link href="static/KYGDEVRRaKjNbTXJkHmicmzo9vFrnnzCnGLcxKjR04f.css" type="text/css" rel="stylesheet" media="screen,print" />

<link href="static/exPgH85S7hDuxmySlOZhM0sayvRJla83G3HHYJNzaUB.css" type="text/css" rel="stylesheet" media="screen,print" />
<link href="static/tNjfADEdRvZz6orXSyopLhQhlHwq7bH7hcAZQiGZMoc.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="/static/RrjzrZ0Ci0GPLETIr8x8KUMjfJtZKvifrUtMCedwKRB.png" rel="shortcut icon" />
<link href="static/4zsVqykqBON8U5Es5kfffXBSGJlbI8VrPDW4hSn1SWJ.css" type="text/css" rel="stylesheet" media="screen, projection" />


<link href="static/sCFm7bBsIMFGQHTSlBbhMHQCXWhOsbBr5z4bu1OueIE.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="static/tUELnv7Uvq6ppWNUWOlaow3JGSTTIf8hJ2VYvh7Oahj.css" type="text/css" rel="stylesheet" media="screen, projection" />
<link href="/static/OKcRcjAeA1yuXD9r4fZA1Uw2HEwL7gYvjc6HdrZXIYP.png" rel="shortcut icon" />
<link href="/static/UxF0saaqmikaj74l2WFcCyPMm9hEEs8if7IBy0GNAnd.png" rel="shortcut icon" />
<link href="/static/zs4hrJqt7I802RlaZiXbmbDBarpNPZF8V8fCQJ2RVTM.png" rel="shortcut icon" />
<link href="/static/SvC1e8bSiCPFh8mObbEThgbJIaGZi72ATzqobK6QnnB.gif" rel="shortcut icon" />
<link href="/static/BA9MhIHZnH0zMcKJWIWsTurHhQTpDYE6akqM5excaZI.gif" rel="shortcut icon" />

<script type="text/javascript">
    var fcConfig = {
        bieUrl: "#",
        speciesProfileUrl: "https://fieldcapture-test.ala.org.au/proxy/speciesProfile",
        googleStaticUrl:"http://maps.googleapis.com/maps/api/staticmap?maptype=terrian&zoom=12&sensor=false&size=350x250&markers=color:red%7C"
        },
        here = document.location.href;
    </script>
    

    <meta name="layout" content="mobile"/>

    
    
    
</if>

    <style type="text/css">
        input[type=checkbox] {  -webkit-transform: scale(1.5); }
        .checkbox-list label { min-height: 40px; }
        .speciesAutocompleteRow {min-height:40px;}
        .datepicker td, .datepicker th {
            width:40px;
            height:40px;
            vertical-align: middle;
        }
    </style>
</head>

<body>

<div id="content" class="clearfix">
    
<div class="container-fluid validationEngineContainer" id="validation-container">
<div id="koActivityMainBlock">

    <div class="row-fluid">
        <div class="span12">
            <!-- Common activity fields -->

            <div class="row-fluid space-after">
                <div class="span4">

                    <label class="for-readonly">Type</label>
                    <span class="readonly-text" data-bind="text:type"></span>
                </div>
                <div class="span8">

                    <label class="for-readonly">Description</label>
                    <span class="readonly-text" data-bind="text:description"></span>
                </div>
            </div>


            <div class="row-fluid space-after">
                <div class="span4">
                    <label class="for-readonly inline">Planned start date</label>
                    <span class="readonly-text" data-bind="text:plannedStartDate.formattedDate"></span>
                </div>
                <div class="span8">
                    <label class="for-readonly inline">Planned end date</label>
                    <span class="readonly-text" data-bind="text:plannedEndDate.formattedDate"></span>
                </div>
            </div>

            <div class="well">
                <div class="row-fluid">

                    <span class="span8">
                    <div class="row-fluid space-after">

                        <div class="span6 required">
                            <label for="startDate"><b>Actual start date</b>
                                <a href='#' class='helphover' data-original-title='Start date' data-placement='top' data-content='Date the activity was started.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a>
                            </label>


                            <div class="input-append">
                                <input data-bind='datepicker:startDate.date' name='startDate' id='startDate' type='text' size='16' class='input-xlarge' readonly='readonly' targetField='startDate.date' data-validation-engine='validate[required]' />
<span class='add-on open-datepicker'>
  <i class='icon-th'>&nbsp;</i>
</span>
                            </div>

                        </div>
                        <div class="span6" data-bind="css:{required:transients.markedAsFinished}">
                            <label for="endDate"><b>Actual end date</b>
                                <a href='#' class='helphover' data-original-title='End date' data-placement='top' data-content='Date the activity finished.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a>
                            </label>

                            <div class="input-append">
                                <input data-bind='datepicker:endDate.date' name='endDate' id='endDate' type='text' size='16' class='input-xlarge' readonly='readonly' targetField='endDate.date' data-validation-engine='validate[future[startDate]]' />
<span class='add-on open-datepicker'>
  <i class='icon-th'>&nbsp;</i>
</span>
                            </div>

                        </div>
                    </div>
                    <div class="row-fluid space-after">
                        <div class="span6">
                            <label for="theme"><b>Major theme</b></label>
                            <select id="theme" data-bind="value:mainTheme, options:transients.themes, optionsCaption:'Choose..'" class="input-xlarge" style="width:90%">
                            </select>
                        </div>

                        <div class="span6">
                            <label><b>Progress</b></label>
                            <label for="activityComplete"><input type="checkbox" id="activityComplete" data-bind="checked:transients.markedAsFinished" style="margin-right:1em;"><span>This activity is complete</span></label>

                        </div>

                    </div>
                    <div class="row-fluid">
                        <div class="span6">
                            <label for="site"><b>Site</b></label>
                            <select id='site' style='width:90%' data-bind='options:transients.sites,optionsText:"name",optionsValue:"siteId",value:siteId,optionsCaption:"Choose a site..."'>&nbsp;</select>

                        </div>

                        <div class="span3">

                            <button class="btn btn-info" style="margin-top:25px;" data-bind="visible:transients.newSiteSupported,click:createNewSite">Create new Site</button>
                        </div>
                    </div>

                    
                        
                            
                                
                            
                            
                                
                                    
                                    
                                    
                                    

                                
                            
                        

                    
                    </span>
                    <span class="span4">

                        <img id="siteLocationImage" width="100%" data-bind="event:{error:siteLoadError}, attr:{src:transients.siteImgUrl}, visible:transients.siteImgUrl()"/>


                    </span>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- ko stopBinding: true -->

    
    
    
    <style type="text/css">
        table.training th {white-space:normal;}
        table.training tbody td:nth-child(1) {width:40%;}
        table.training tbody td:nth-child(1)
        table.training tbody td:nth-child(2) {width:40%;}
        table.training tbody td:nth-child(2)
        table.training tbody td:nth-child(3) {width:20%;}
        table.training tbody td:nth-child(3)
        table.training td:last-child {width:4%;text-align:center;}
        table.training textarea {width:100%; box-sizing:border-box; }
        table.training select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.null th {white-space:normal;}
        table.null tbody td:nth-child(1) {width:20%;text-align:center;}
        table.null tbody td:nth-child(1)
        table.null tbody td:nth-child(2) {width:80%;}
        table.null tbody td:nth-child(2)
        table.null td:last-child {width:4%;text-align:center;}
        table.null textarea {width:100%; box-sizing:border-box; }
        table.null select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.null th {white-space:normal;}
        table.null tbody td:nth-child(1) {width:20%;text-align:center;}
        table.null tbody td:nth-child(1)
        table.null tbody td:nth-child(2) {width:80%;}
        table.null tbody td:nth-child(2)
        table.null td:last-child {width:4%;text-align:center;}
        table.null textarea {width:100%; box-sizing:border-box; }
        table.null select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.null th {white-space:normal;}
        table.null tbody td:nth-child(1) {width:20%;text-align:center;}
        table.null tbody td:nth-child(1)
        table.null tbody td:nth-child(2) {width:80%;}
        table.null tbody td:nth-child(2)
        table.null td:last-child {width:4%;text-align:center;}
        table.null textarea {width:100%; box-sizing:border-box; }
        table.null select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.complaints th {white-space:normal;}
        table.complaints tbody td:nth-child(1) {width:15%;}
        table.complaints tbody td:nth-child(1)
        table.complaints tbody td:nth-child(2) {width:42%;}
        table.complaints tbody td:nth-child(2)
        table.complaints tbody td:nth-child(3) {width:43%;}
        table.complaints tbody td:nth-child(3)
        table.complaints td:last-child {width:4%;text-align:center;}
        table.complaints textarea {width:100%; box-sizing:border-box; }
        table.complaints select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.null th {white-space:normal;}
        table.null tbody td:nth-child(1) {width:10%;text-align:center;}
        table.null tbody td:nth-child(1)
        table.null tbody td:nth-child(2) {width:10%;text-align:center;}
        table.null tbody td:nth-child(2)
        table.null tbody td:nth-child(3) {width:10%;text-align:center;}
        table.null tbody td:nth-child(3)
        table.null tbody td:nth-child(4) {width:10%;text-align:center;}
        table.null tbody td:nth-child(4)
        table.null tbody td:nth-child(5) {width:10%;text-align:center;}
        table.null tbody td:nth-child(5)
        table.null tbody td:nth-child(6) {width:10%;text-align:center;}
        table.null tbody td:nth-child(6)
        table.null tbody td:nth-child(7) {width:10%;text-align:center;}
        table.null tbody td:nth-child(7)
        table.null tbody td:nth-child(8) {width:10%;text-align:center;}
        table.null tbody td:nth-child(8)
        table.null tbody td:nth-child(9) {width:10%;text-align:center;}
        table.null tbody td:nth-child(9)
        table.null td:last-child {width:4%;text-align:center;}
        table.null textarea {width:100%; box-sizing:border-box; }
        table.null select {width:100%; box-sizing:border-box; }
    </style><style type="text/css">
        table.incidents th {white-space:normal;}
        table.incidents tbody td:nth-child(1) {width:20%;}
        table.incidents tbody td:nth-child(1)
        table.incidents tbody td:nth-child(2) {width:20%;}
        table.incidents tbody td:nth-child(2)
        table.incidents tbody td:nth-child(3) {width:10%;}
        table.incidents tbody td:nth-child(3)
        table.incidents tbody td:nth-child(4) {width:50%;}
        table.incidents tbody td:nth-child(4)
        table.incidents td:last-child {width:4%;text-align:center;}
        table.incidents textarea {width:100%; box-sizing:border-box; }
        table.incidents select {width:100%; box-sizing:border-box; }
    </style>
    <div class="output-block" id="koThree_Monthly_Report">
            <h3 data-bind="css:{modified:dirtyFlag.isDirty},attr:{title:'Has been modified'}">Three Monthly Report</h3>
        <div data-bind="if:transients.optional">
            <label class="checkbox" ><input type="checkbox" data-bind="checked:outputNotCompleted"> <span data-bind="text:transients.questionText"></span> </label>
        </div>
        <div id="Three_Monthly_Report-content" data-bind="visible:!outputNotCompleted()">
        <!-- add the dynamic components -->
            <div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>List of Training Activities</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Provide a list of the training activities (from nationally endorsed skills sets) undertaken by Participants in this Project during this reporting period.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered training " >
                <thead><tr><th>Name of Training Activity<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Title of each distinct training course that participants attended during the reporting period.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Training Provider<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The name of the provider of each distinct training course.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>State/Territory Training Undertaken</th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'trainingviewTmpl', foreach: data.training}"></tbody>
                <script id="trainingviewTmpl" type="text/html"><tr>
                    <td><input  class="input-large" data-bind='value:trainingActivityName'  type='text' class='input-small'/></td>
                    <td><input  class="input-large" data-bind='value:trainingProvider'  type='text' class='input-small'/></td>
                    <td><select data-bind='value:trainingState,options:transients.trainingStateConstraints,optionsCaption:"Please select"'></select></td>
                    <td><i data-bind='click:$root.removetrainingRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="4" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addtrainingRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="trainingtemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="trainingtemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>Participant Withdrawals and Exits</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Provide a summary of reasons for Participant withdrawals (Participant initiated) and Participant exits (Service Provider initiated) during this reporting period in the two tables below. The summary should provide a short explanation for each withdrawal and exit.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered null " >
                <thead><tr><th class="required">No. of Withdrawals<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of participants that voluntarily withdrew from the Green Army Programme during the reporting period.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Summary of Reasons<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Provide a summary of the reasons why participants withdrew from the Programme.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th>
                </tr></thead>
                <tbody data-bind="template:{name:'1viewTmpl', data: data}"></tbody>
                <script id="1viewTmpl" type="text/html"><tr>
                    <td><input class="input-small" style="text-align:center" data-bind='value:participantWithdrawals' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><textarea  data-bind='value:participantWithdrawalReasons'></textarea></td>
                </tr></script>
                <tfoot>
                </tfoot>
            </table>
        </div>
<div class="row-fluid output-section">
            <table class="table table-bordered null " >
                <thead><tr><th class="required">No. of Exits<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of participants that the service provider &apos;exited&apos; from the Green Army Programme during the reporting period.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Summary of Reasons<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Provide a summary of the reasons why participants were &apos;exited&apos; from the Programme.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th>
                </tr></thead>
                <tbody data-bind="template:{name:'2viewTmpl', data: data}"></tbody>
                <script id="2viewTmpl" type="text/html"><tr>
                    <td><input class="input-small" style="text-align:center" data-bind='value:participantExits' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><textarea  data-bind='value:participantExitReasons'></textarea></td>
                </tr></script>
                <tfoot>
                </tfoot>
            </table>
        </div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>Participants Exiting Training</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Provide a summary of reasons why Participants did not fulfil the requirements of their Training Plans during this reporting period in the table below. This might include Participants who exited the Project early or opted out of training for the remainder of the Project. The summary should provide a short explanation for each identified Participant.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered null " >
                <thead><tr><th class="required">No. who did not complete training<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The number of participants who commenced, but did not complete training.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Summary of Reasons<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Provide a summary of the reasons why participants did not complete training.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th>
                </tr></thead>
                <tbody data-bind="template:{name:'3viewTmpl', data: data}"></tbody>
                <script id="3viewTmpl" type="text/html"><tr>
                    <td><input class="input-small" style="text-align:center" data-bind='value:participantTrainingNcNumber' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><textarea  data-bind='value:participantTrainingNcReasons'></textarea></td>
                </tr></script>
                <tfoot>
                </tfoot>
            </table>
        </div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>Complaints Received</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Provide a summary of reasons why Participants did not fulfil the requirements of their Training Plans during this reporting period in the table below. This might include Participants who exited the Project early or opted out of training for the remainder of the Project. The summary should provide a short explanation for each identified Participant.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered complaints " >
                <thead><tr><th>Date complaint received<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='The date on which a complaint was received by the Service Provider.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Brief description of complaint<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Describe the nature of the complaint and any relevant details.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>How was the complaint handled?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Explain how the complaint was handled by the Service Provider.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'complaintsviewTmpl', foreach: data.complaints}"></tbody>
                <script id="complaintsviewTmpl" type="text/html"><tr>
                    <td><div class="input-append"><input data-bind="datepicker:complaintDate.date" type="text" size="12"/><span class="add-on open-datepicker"><i class="icon-th"></i></span></div></td>
                    <td><textarea  data-bind='value:complaintDescription'></textarea></td>
                    <td><textarea  data-bind='value:complaintHandling'></textarea></td>
                    <td><i data-bind='click:$root.removecomplaintsRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="4" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addcomplaintsRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="complaintstemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="complaintstemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>Participant Demographics</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Please provide information on the age range of all participants that commenced on the Project during this reporting period. The total number must agree with the sum of the monthly totals for this three month period for Participants commencing.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered null " >
                <thead><tr><th class="required">17 yrs</th><th class="required">18 yrs</th><th class="required">19 yrs</th><th class="required">20 yrs</th><th class="required">21 yrs</th><th class="required">22 yrs</th><th class="required">23 yrs</th><th class="required">24 yrs</th><th>Total Participants</th>
                </tr></thead>
                <tbody data-bind="template:{name:'4viewTmpl', data: data}"></tbody>
                <script id="4viewTmpl" type="text/html"><tr>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no17Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no18Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no19Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no20Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no21Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no22Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no23Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><input class="input-mini" style="text-align:center" data-bind='value:no24Years' data-validation-engine='validate[required,min[0],custom[number]]' type='number' class='input-mini'/></td>
                    <td><span  data-bind='text:totalParticipants'></span></td>
                </tr></script>
                <tfoot>
                </tfoot>
            </table>
        </div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12"><h4>List of Incidents</h4></span></span></div>
<div class="row-fluid space-after " >
<span class="span12">    <span  class="span12">Provide a list of all incidents, whether Notifiable  or not, including breaches of the Participant code of conduct, that occurred during this reporting period.</span></span></div>
<div class="row-fluid output-section">
            <table class="table table-bordered incidents " >
                <thead><tr><th>Incident Type<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Select the most appropriate type of incident.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Resulting Injury/Illness<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Select the most appropriate type on injury or illness.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Was the incident notifiable?<a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Indicate whether this injury or illness was notifiable. Refer to programme guidelines for a list of notifiable incidents.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th>Description of incident and resulting injury/illness and remedial action/s taken to address incident <br><i>(including any insurance claim by the Participant, and/or to decrease the likelihood of re-occurrence where required)</i><a href='#' class='helphover' data-original-title='' data-placement='top' data-content='Provide a brief description of the injury or illness.'>
  <i class='icon-question-sign'>&nbsp;</i>
</a></th><th></th>
                </tr></thead>
                <tbody data-bind="template:{name:'incidentsviewTmpl', foreach: data.incidents}"></tbody>
                <script id="incidentsviewTmpl" type="text/html"><tr>
                    <td><select data-bind='value:incidentType,options:transients.incidentTypeConstraints,optionsCaption:"Please select"'></select></td>
                    <td><select data-bind='value:resultingInjury,options:transients.resultingInjuryConstraints,optionsCaption:"Please select"'></select></td>
                    <td><select data-bind='value:incidentNotifiable,options:transients.incidentNotifiableConstraints,optionsCaption:"Please select"'></select></td>
                    <td><textarea  data-bind='value:incidentDescription'></textarea></td>
                    <td><i data-bind='click:$root.removeincidentsRow' class='icon-remove'></i></td>
                </tr></script>
                <tfoot>
                <tr><td colspan="5" style="text-align:left;">
                        <button type="button" class="btn btn-small" data-bind="click:addincidentsRow">
                        <i class="icon-plus"></i> Add a row</button></td></tr> <script id="incidentstemplate-upload" type="text/x-tmpl">{% %}</script>
                       <script id="incidentstemplate-download" type="text/x-tmpl">{% %}</script>                </tfoot>
            </table>
        </div>

        </div>
        
    </div>
    

<!-- /ko -->

</div>




</div>

<script src="static/Zbj0J8XhmZDqWqIAz5C46TWLOULGl7LNvdJeBlO9fMb.js" type="text/javascript" ></script>





<script src="static/5zeDycYZFxJsfDd3W1kuhrN47XnIMrbhS6gdHDvcExv.js" type="text/javascript" ></script>

<script src="static/ulxBmo4RrKTNT3DuFHethb4EOZpwQfvefxNXivDIbzp.js" type="text/javascript" ></script>








<!--[if gte IE 8]><script src="static/knxjs4G9Cquc79O3iYW107XikPB1Z1ii8QWrtBpzlSP.js" type="text/javascript" ></script><![endif]-->
<script src="static/nRrltgvxdEHd5BqRR1v4XU3ZStOrhDScuH03g4r8E6O.js" type="text/javascript" ></script>

<script src="static/zP22SFJVnKXoWuBJdbsNhcivH2iXiC57wEOHXSDNudf.js" type="text/javascript" ></script>

<script src="static/QjmKsgTA1QWYxF0gcpdSFROG8mBnzaabMZcvDxBb9Xo.js" type="text/javascript" ></script>






<script src="static/IZCc6ZgD3MepYbz4UqlDLzMDNNghSCivcfGebmF9V2d.js" type="text/javascript" ></script>
<script src="static/I4NiLd8qMXMMgs4hAqHb5YT0jGlQhM4Yp0dku4W1Wng.js" type="text/javascript" ></script>



<script src="static/e9gGniNN5cG3OR4oPVWd5lYoxE5Xf282hFe7d4FTQbq.js" type="text/javascript" ></script>


<script src="static/CRNxISj7t7ZCV7B8M8dFtBK7x7R4tGVO36INoBz8gQX.js" type="text/javascript" ></script>

<script src="static/QhlSgFWjl35vcaCRa5cKxHZxRWSSluzptQUKz3PHr9s.js" type="text/javascript" ></script>


<script src="static/8WCQyXwicnBgTdLQ4F5jUFtmVXmqG9eUZKvo74wOnIT.js" type="text/javascript" ></script>
<script src="static/9HtLc6nfgO9H72LVVZxetW45ZR623Fx8EhEdydgOq2F.js" type="text/javascript" ></script>
<script src="static/wkrwT3eqoZlWXFPCQRTvkdsdvwzT5Lw2H89f9eTkQdb.js" type="text/javascript" ></script>


<script type="text/javascript">
        $(function(){

            var viewModelName = "Three_Monthly_ReportViewModel",
                viewModelInstance = viewModelName + "Instance";

            // load dynamic models - usually objects in a list
                    var TrainingRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.trainingActivityName = ko.observable(orBlank(data['trainingActivityName']));
            this.trainingProvider = ko.observable(orBlank(data['trainingProvider']));
            this.trainingState = ko.observable(orBlank(data['trainingState']));
            self.transients.trainingStateConstraints = ["ACT","NSW","NT","QLD","SA","TAS","VIC","WA"];
        };
        var ComplaintsRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.complaintDate = ko.observable(orBlank(data['complaintDate'])).extend({simpleDate: false});
            this.complaintDescription = ko.observable(orBlank(data['complaintDescription']));
            this.complaintHandling = ko.observable(orBlank(data['complaintHandling']));
        };
        var IncidentsRow = function (data) {
            var self = this;
            if (!data) data = {};
            self.transients = {};
            this.incidentType = ko.observable(orBlank(data['incidentType']));
            self.transients.incidentTypeConstraints = ["Animal Attack","Assault","Bullying and/or Harassment","Caught or Crushed Between Objects","Explosion","Exposure to Biological Factors (eg. virus, bacteria, disease, etc)","Exposure to Chemical Materials or Fumes","Exposure to Electricity","Exposure to Heat/Cold","Exposure to Noise","Exposure to Flora","Exposure to Radiation","Fall From Height","Hit By Moving or Falling Object","Hit Object With Part of Body (including rubbing and chaffing)","Insect or Spider Attack","Manual Handling/Body Stressors (eg. lifting, carrying, putting down, repetitive movement, etc)","Slip or Trip","Vehicle Accident","Other"];
            this.resultingInjury = ko.observable(orBlank(data['resultingInjury']));
            self.transients.resultingInjuryConstraints = ["Not applicable/None","Asphyxiation","Burn (including electrical, chemical and friction)","Contusion, Bruising and Superficial Crushing","Death","Digestive System Disorder","Dislocation","Drowning","Effect of Heat/Cold Exposure (eg. hyperthermia, hypothermia, etc)","Electrocution","Foreign Body","Fracture or Break","Head Injury","Infectious or Parasitic Disease","Internal Injury","Laceration or Open Wound","Medical Sharp or Needle-Stick Puncture","Mental Disorder (including stress and shock)","Muscle, Tendon or Soft Tissue Disorder","Nervous System or Spinal Disorder","Poisoning and Toxic Effects","Respiratory System Disease","Sense Organ Disorder","Skin Disease","Superficial Injury (eg. abrasion, bite from non-venomous spider or insect, etc)","Traumatic Amputation","Travel/Motion Sickness","Other"];
            this.incidentNotifiable = ko.observable(orBlank(data['incidentNotifiable']));
            self.transients.incidentNotifiableConstraints = ["Yes","No"];
            this.incidentDescription = ko.observable(orBlank(data['incidentDescription']));
        };
        var speciesLists = [];
        var site = {};


            this[viewModelName] = function (output, config) {
                var self = this;
                self.name = "Three Monthly Report";
                self.outputId = orBlank(output.outputId);

                self.data = {};
                self.transients = {};
                var notCompleted = output.outputNotCompleted;

                if (notCompleted === undefined) {
                    notCompleted = config.collapsedByDefault;
                }
                self.outputNotCompleted = ko.observable(notCompleted);
                self.transients.optional = config.optional || false;
                self.transients.questionText = config.optionalQuestionText || 'Not applicable';
                self.transients.dummy = ko.observable();

                // add declarations for dynamic data
                
            self.data.training = ko.observableArray([]);
            self.selectedtrainingRow = ko.observable();
        

            self.loadtraining = function (data, append) {
                if (!append) {
                    self.data.training([]);
                }
                if (data === undefined) {
                    self.addtrainingRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.training.push(new TrainingRow(obj));
                    });
                }
            };

            self.addtrainingRow = function () {
                var newRow = new TrainingRow();
                self.data.training.push(newRow);
                
            };
            self.removetrainingRow = function (row) {
                self.data.training.remove(row);
                
            };
            self.trainingrowCount = function () {
                return self.data.training().length;
            };

            self.trainingTableDataUploadVisible = ko.observable(false);
            self.showtrainingTableDataUpload = function() {
                self.trainingTableDataUploadVisible(!self.trainingTableDataUploadVisible());
            };

            self.trainingTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadtraining(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "trainingtemplate-upload",
                    downloadTemplateId: "trainingtemplate-download",
                    formData:{type:'Three Monthly Report', listName:'training'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.trainingActivityCount = ko.computed(function () {
                return self.data.training().length;
            });

            self.data.participantWithdrawals = ko.observable();

            self.data.participantWithdrawalReasons = ko.observable();

            self.data.participantExits = ko.observable();

            self.data.participantExitReasons = ko.observable();

            self.data.participantTrainingNcNumber = ko.observable();

            self.data.participantTrainingNcReasons = ko.observable();

            self.data.complaints = ko.observableArray([]);
            self.selectedcomplaintsRow = ko.observable();
        

            self.loadcomplaints = function (data, append) {
                if (!append) {
                    self.data.complaints([]);
                }
                if (data === undefined) {
                    self.addcomplaintsRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.complaints.push(new ComplaintsRow(obj));
                    });
                }
            };

            self.addcomplaintsRow = function () {
                var newRow = new ComplaintsRow();
                self.data.complaints.push(newRow);
                
            };
            self.removecomplaintsRow = function (row) {
                self.data.complaints.remove(row);
                
            };
            self.complaintsrowCount = function () {
                return self.data.complaints().length;
            };

            self.complaintsTableDataUploadVisible = ko.observable(false);
            self.showcomplaintsTableDataUpload = function() {
                self.complaintsTableDataUploadVisible(!self.complaintsTableDataUploadVisible());
            };

            self.complaintsTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadcomplaints(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "complaintstemplate-upload",
                    downloadTemplateId: "complaintstemplate-download",
                    formData:{type:'Three Monthly Report', listName:'complaints'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.complaintCount = ko.computed(function () {
                return self.data.complaints().length;
            });

            self.data.no17Years = ko.observable();

            self.data.no18Years = ko.observable();

            self.data.no19Years = ko.observable();

            self.data.no20Years = ko.observable();

            self.data.no21Years = ko.observable();

            self.data.no22Years = ko.observable();

            self.data.no23Years = ko.observable();

            self.data.no24Years = ko.observable();

            self.data.totalParticipants = ko.computed(function () {
var total = 0;total += Number(self.data.no17Years());
total += Number(self.data.no18Years());
total += Number(self.data.no19Years());
total += Number(self.data.no20Years());
total += Number(self.data.no21Years());
total += Number(self.data.no22Years());
total += Number(self.data.no23Years());
total += Number(self.data.no24Years());
                return total;            });

            self.data.incidents = ko.observableArray([]);
            self.selectedincidentsRow = ko.observable();
        

            self.loadincidents = function (data, append) {
                if (!append) {
                    self.data.incidents([]);
                }
                if (data === undefined) {
                    self.addincidentsRow();
                } else {
                    $.each(data, function (i, obj) {
                        self.data.incidents.push(new IncidentsRow(obj));
                    });
                }
            };

            self.addincidentsRow = function () {
                var newRow = new IncidentsRow();
                self.data.incidents.push(newRow);
                
            };
            self.removeincidentsRow = function (row) {
                self.data.incidents.remove(row);
                
            };
            self.incidentsrowCount = function () {
                return self.data.incidents().length;
            };

            self.incidentsTableDataUploadVisible = ko.observable(false);
            self.showincidentsTableDataUpload = function() {
                self.incidentsTableDataUploadVisible(!self.incidentsTableDataUploadVisible());
            };

            self.incidentsTableDataUploadOptions = {
                    url:'/activity/ajaxUpload',
                    done:function(e, data) {
                        if (data.result.error) {
                            self.uploadFailed(data.result.error);
                        }
                        else {
                            self.loadincidents(data.result.data, self.appendTableRows());
                        }
                    },
                    fail:function(e, data) {
                        var message = 'Please contact MERIT support and attach your spreadsheet to help us resolve the problem';
                        self.uploadFailed(data);

                    },
                    uploadTemplateId: "incidentstemplate-upload",
                    downloadTemplateId: "incidentstemplate-download",
                    formData:{type:'Three Monthly Report', listName:'incidents'}
            };
            self.appendTableRows = ko.observable(true);
            self.uploadFailed = function(message) {
                        var text = "<span class='label label-important'>Important</span><h4>There was an error uploading your data.</h4>";
                        text += "<p>"+message+"</p>";
                        bootbox.alert(text)
            };

            self.data.incidentCount = ko.computed(function () {
                return self.data.incidents().length;
            });
            self.transients.site = site;

                // this will be called when generating a savable model to remove transient properties
                self.removeBeforeSave = function (jsData) {
                    // add code to remove any transients added by the dynamic tags
                                    delete jsData.selectedtrainingRow;
                delete jsData.trainingTableDataUploadOptions
                delete jsData.trainingTableDataUploadVisible
                delete jsData.selectednullRow;
                delete jsData.nullTableDataUploadOptions
                delete jsData.nullTableDataUploadVisible
                delete jsData.selectednullRow;
                delete jsData.nullTableDataUploadOptions
                delete jsData.nullTableDataUploadVisible
                delete jsData.selectednullRow;
                delete jsData.nullTableDataUploadOptions
                delete jsData.nullTableDataUploadVisible
                delete jsData.selectedcomplaintsRow;
                delete jsData.complaintsTableDataUploadOptions
                delete jsData.complaintsTableDataUploadVisible
                delete jsData.selectednullRow;
                delete jsData.nullTableDataUploadOptions
                delete jsData.nullTableDataUploadVisible
                delete jsData.selectedincidentsRow;
                delete jsData.incidentsTableDataUploadOptions
                delete jsData.incidentsTableDataUploadVisible

                    delete jsData.activityType;
                    delete jsData.transients;
                    return jsData;
                };

                // this returns a JS object ready for saving
                self.modelForSaving = function () {
                    // get model as a plain javascript object
                    var jsData = ko.mapping.toJS(self, {'ignore':['transients']});
                    if (self.outputNotCompleted()) {
                        jsData.data = {};
                    }
                    // get rid of any transient observables
                    return self.removeBeforeSave(jsData);
                };

                // this is a version of toJSON that just returns the model as it will be saved
                // it is used for detecting when the model is modified (in a way that should invoke a save)
                // the ko.toJSON conversion is preserved so we can use it to view the active model for debugging
                self.modelAsJSON = function () {
                    return JSON.stringify(self.modelForSaving());
                };

                self.loadData = function (data) {
                    // load dynamic data
                                    self.loadtraining(data.training);
                self.data['participantWithdrawals'](orZero(data['participantWithdrawals']));
                self.data['participantWithdrawalReasons'](data['participantWithdrawalReasons']);
                self.data['participantExits'](orZero(data['participantExits']));
                self.data['participantExitReasons'](data['participantExitReasons']);
                self.data['participantTrainingNcNumber'](orZero(data['participantTrainingNcNumber']));
                self.data['participantTrainingNcReasons'](data['participantTrainingNcReasons']);
                self.loadcomplaints(data.complaints);
                self.data['no17Years'](orZero(data['no17Years']));
                self.data['no18Years'](orZero(data['no18Years']));
                self.data['no19Years'](orZero(data['no19Years']));
                self.data['no20Years'](orZero(data['no20Years']));
                self.data['no21Years'](orZero(data['no21Years']));
                self.data['no22Years'](orZero(data['no22Years']));
                self.data['no23Years'](orZero(data['no23Years']));
                self.data['no24Years'](orZero(data['no24Years']));
                self.loadincidents(data.incidents);


                    // if there is no data in tables then add an empty row for the user to add data
                    if (typeof self.addRow === 'function' && self.rowCount() === 0) {
                        self.addRow();
                    }
                    self.transients.dummy.notifySubscribers();
                };
            };


            var savedData = activity;
            if (!savedData.outputs) {
                savedData.outputs = [];
            }
            var savedOutput = {};
            if (savedData) {

                $.each(savedData.outputs, function(i, tmpOutput) {
                    if (tmpOutput.name === 'Three Monthly Report') {
                        savedOutput = tmpOutput;
                    }
                });
            }

            var config = JSON.parse('\u007b\u007d');
            window[viewModelInstance] = new this[viewModelName](savedOutput, config);
            var output = savedOutput.data ? savedOutput.data : {};

            window[viewModelInstance].loadData(output);
            window[viewModelInstance].dirtyFlag = ko.dirtyFlag(window[viewModelInstance], false);

            ko.applyBindings(window[viewModelInstance], document.getElementById("koThree_Monthly_Report"));

            // this resets the baseline for detecting changes to the model
            // - shouldn't be required if everything behaves itself but acts as a backup for
            //   any binding side-effects
            // - note that it is not foolproof as applying the bindings happens asynchronously and there
            //   is no easy way to detect its completion
            window[viewModelInstance].dirtyFlag.reset();

            // register with the master controller so this model can participate in the save cycle
            master.register(window[viewModelInstance], window[viewModelInstance].modelForSaving,
            window[viewModelInstance].dirtyFlag.isDirty, window[viewModelInstance].dirtyFlag.reset);
        });

        </script><script type="text/javascript">


    /* Master controller for page. This handles saving each model as required. */
    var Master = function () {
        var self = this;
        this.subscribers = [];
        // client models register their name and methods to participate in saving
        self.register = function (modelInstanceName, getMethod, isDirtyMethod, resetMethod) {
            this.subscribers.push({
                model: modelInstanceName,
                get: getMethod,
                isDirty: isDirtyMethod,
                reset: resetMethod
            });
        };
        // master isDirty flag for the whole page - can control button enabling
        this.isDirty  = function () {
            var dirty = false;
            $.each(this.subscribers, function(i, obj) {
                dirty = dirty || obj.isDirty();
            });
            return dirty;
        };

        this.validate = function() {
            var valid = $('#validation-container').validationEngine('validate');
            if (valid) {
                // Check that forms with multiple optional sections have at least one of those sections completed.
                var optionalCount = 0;
                var notCompletedCount = 0;
                $.each(self.subscribers, function(i, obj) {
                    if (obj.model !== 'activityModel' && obj.model !== 'photoPoints') {
                        if (obj.model.transients.optional) {
                            optionalCount++;
                            if (obj.model.outputNotCompleted()) {
                                notCompletedCount++;
                            }
                        }
                    }
                });
                if (optionalCount > 1 && notCompletedCount == optionalCount) {
                   valid = false;
                   bootbox.alert("<p>To 'Save changes', the mandatory fields of at least one section of this form must be completed.</p>"+
                        "<p>If all sections are 'Not applicable' please contact your grant manager to discuss alternate form options</p>");
                }
            }

            return valid;
        };
        /**
         * Makes an ajax call to save any sections that have been modified. This includes the activity
         * itself and each output.
         *
         * Modified outputs are injected as a list into the activity object. If there is nothing to save
         * in the activity itself, then the root is an object that is empty except for the outputs list.
         *
         * NOTE that the model for each section must register itself to be included in this save.
         *
         * Validates the entire page before saving.
         * @return -1 if the page was not modified, 0 if validation failed, 1 if validation succeeded (or was not requested).
         */
        this.save = function (validate) {
            // Ensure any active change is committed - the knockout binding typically fires on blur.
            $( document.activeElement ).blur();

            if (validate === undefined) {
                validate = true;
            }
            var activityData, outputs = [];

            var success = true;
            if (validate) {
                success = self.validate();
            }
            if (!self.isDirty()) {
                mobileBindings.onSaveActivity(-1, null);
                return -1;
            }
            if (success) {
                $.each(this.subscribers, function(i, obj) {
                    if (obj.model === 'activityModel') {
                        activityData = obj.get();
                    } else {
                        outputs.push(obj.get());
                    }
                });

                if (activityData === undefined) { activityData = {}}
                activityData.outputs = outputs;

                var toSave = JSON.stringify(activityData);
                mobileBindings.onSaveActivity(1, toSave);

            }
            else {
                mobileBindings.onSaveActivity(0, null);
            }
            return success?1:0;
        };

        this.reset = function () {
            $.each(this.subscribers, function(i, obj) {
                if (obj.isDirty()) {
                    obj.reset();
                }
            });
        };

        this.addSite = function(site) {
            var viewModel = ko.dataFor(document.getElementById('site'));
            viewModel.transients.sites.push(site);
            viewModel.siteId(site.siteId);
        }
    };

    if (mobileBindings == undefined) {
        var mobileBindings = {
        
            loadActivity:function(){return "{}"},
        
        
            loadSites:function(){return "[]"},
        
        
            loadThemes:function(){return "[]"},
        

        supportsNewSite:function() { return true; },
        onSaveActivity:function(){},
        createNewSite:function(){}
    };
}
var master = new Master();
var activity = JSON.parse(mobileBindings.loadActivity());
var sites = JSON.parse(mobileBindings.loadSites());
var themes = JSON.parse(mobileBindings.loadThemes());

$(function(){

var scroll = false;

$('#validation-container').validationEngine('attach', {scroll: scroll});

$('.helphover').popover({animation: true, trigger:'hover'});

$('#reset').click(function () {
master.reset();
});

function ViewModel (act, sites, themes) {
var self = this;
var today = new Date().toISOStringNoMillis();

self.activityId = act.activityId;
self.description = ko.observable(act.description);
self.notes = ko.observable(act.notes);
self.startDate = ko.observable(act.startDate || today).extend({simpleDate: false});
self.endDate = ko.observable(act.endDate).extend({simpleDate: false});
self.plannedStartDate = ko.observable(act.plannedStartDate).extend({simpleDate: false});
self.plannedEndDate = ko.observable(act.plannedEndDate).extend({simpleDate: false});
self.eventPurpose = ko.observable(act.eventPurpose);
self.fieldNotes = ko.observable(act.fieldNotes);
self.associatedProgram = ko.observable(act.associatedProgram);
self.associatedSubProgram = ko.observable(act.associatedSubProgram);
self.progress = ko.observable(act.progress);
self.mainTheme = ko.observable(act.mainTheme);
self.type = ko.observable(act.type);
self.siteId = ko.observable(act.siteId);
self.projectId = act.projectId;
self.transients = {};
self.transients.sites = ko.observableArray(sites);
self.transients.photoPoints = ko.computed(function() {
    var site = $.grep(self.transients.sites(), function(site, index) { return site.siteId == self.siteId(); })[0];
     if (site) {
         return site.photoPoints ? site.photoPoints : site.poi;
     }
     return [];
});
self.transients.activityProgressValues = ['planned','started','finished'];
self.transients.themes = themes?themes:[];
self.transients.markedAsFinished = ko.observable(act.progress === 'finished');
self.transients.markedAsFinished.subscribe(function (finished) {
    self.progress(finished ? 'finished' : 'started');
    if (finished || !self.endDate()) {
        self.endDate(today);
    }
});
self.transients.siteImgUrl = ko.computed(function() {
    if (self.siteId()) {
         var site = $.grep(self.transients.sites(), function(site, index) { return site.siteId == self.siteId(); })[0];
         if (site) {
            var lat,lon;
            if (site.centroidLat !== undefined && site.centroidLon !== undefined) {
                lat = site.centroidLat;
                lon = site.centroidLon;
            }
            else if (site.extent && site.extent.geometry && site.extent.geometry.centre) {
                lat = site.extent.geometry.centre[1];
                lon = site.extent.geometry.centre[0];
            }
            if (lat !== undefined && lon !== undefined) {
                $('#siteLocationImage').show();
                return fcConfig.googleStaticUrl+lat+","+lon;
            }
         }
    }
    return "";
});
self.siteLoadError = function(data, event) {
    $('#siteLocationImage').hide();
};

self.transients.newSiteSupported = ko.observable( mobileBindings.supportsNewSite());

self.modelForSaving = function () {
    // get model as a plain javascript object
    var jsData = ko.toJS(self);
    delete jsData.transients;
    return jsData;
};
self.modelAsJSON = function () {
    return JSON.stringify(self.modelForSaving());
};

self.save = function (callback, key) {
};

self.createNewSite = function() {
    mobileBindings.createNewSite();
}

self.notImplemented = function () {
    alert("Not implemented yet.")
};

self.attachPhotoPoint = function(e) {
    console.log(e);
};
self.dirtyFlag = ko.dirtyFlag(self, false);

// make sure progress moves to started if we save any data (unless already finished)
// (do this here so the model becomes dirty)
self.progress(self.transients.markedAsFinished() ? 'finished' : 'started');
}


var viewModel = new ViewModel(activity, sites, themes);

ko.applyBindings(viewModel);

master.register('activityModel', viewModel.modelForSaving, viewModel.dirtyFlag.isDirty, viewModel.dirtyFlag.reset);


});


</script>
</body>
</html>